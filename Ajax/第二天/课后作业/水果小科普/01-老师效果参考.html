<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>欢迎来到水果世界</title>
</head>
<style>
    * {
        padding: 0;
        margin: 0;
        list-style: none;
    }

    html,
    body {
        width: 100%;
        height: 100%;
    }

    #box {
        width: 100%;
        height: 100%;
        margin: 0 auto;
        min-width: 650px;
        overflow: hidden;
    }

    .content {
        width: 100%;
        border: 1px solid #00a383;
        height: 100%;
        overflow: hidden;
        box-sizing: border-box;
        display: flex;
    }

    .nav {
        height: 40px;
        padding-left: 15px;
        line-height: 40px;
        font-weight: bold;
        color: #00a383;
        border-bottom: 3px solid #00a383;

    }

    .list {
        overflow: auto;
        width: 200px;
        margin-bottom: 40px;
    }

    .list img{
        vertical-align: middle;
    }

    .item {
        padding-left: 15px;
        line-height: 30px;
        cursor: pointer;
        transition: all .5s;
    }

    .active,
    .item:hover {
        color: #fff;
        background: #00a383 !important;
    }

    .item:nth-child(odd) {
        background: rgba(0, 0, 0, .1);
    }

    .info {
        display: inline-block;
        flex: 1;
        height: 100%;
        color: #000;
        text-align: center;
    }

    .info .story h5{
        margin-top: 10px;
    }

    .info .story p{
        padding: 30px 50px;
        text-align: left;
        line-height: 30px;
        font-weight: 500;
        text-indent:2em;
    }


    .name {
        text-align: center;
        line-height: 30px;
        border-bottom: 1px solid #ccc;
        font-weight: bold;
        margin-top: 15px;
    }

    .img {
        margin: 15px 0;
        text-align: center;
        max-height: 45%;
        overflow: hidden;
        /* 伸缩盒子实现图片居中 */
        display: flex;
        align-items: center;
        justify-content: center;
        vertical-align: middle;
    }

    .img>img {
        width: 120px;
        height: 120px;
        object-fit: cover;
    }

    h5 {
        font-size: 18px;
    }

    #loading {
        position: absolute;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgb(22, 27, 31);
        display: flex;
        justify-content: center;
        align-items: center;
    }
</style>

<body>
    <div id="box">
        <div class="nav">
            <span>水果列表</span>
        </div>
        <div class="content">
            <!-- 水果列表 -->
            <ul class="list">

            </ul>
            <!-- 水果详情 -->
            <div class="info">

            </div>
        </div>
    </div>
    <div id="loading">
        <img src="./loading.gif" alt="">
    </div>

    <!-- 1.导包 -->
    <script src="./libs/jquery-1.12.4.js"></script>
    <script src="./libs/template-web.js"></script>

    <!-- 2.写模板 -->
    <!-- 2.1 水果列表模板 -->
    <script id="fruit_list" type="text/html">
        {{ each data v }}
        <li class="item" fruit-id="{{ v.id }}">
            <span>{{ v.name }}</span>
            <img width="20px" src="{{ v.icon }}" alt="">
        </li>
        {{ /each }}
    </script>

    <!-- 2.2 水果详情模板 -->
    <script id="fruit_info" type="text/html">
        <div class="bg">
            <div class="name" style="color:red">水果名称:{{ data.name }}</div>
                <div class='img'>
                    <img src="{{ data.icon }}" alt="">
                </div>
                <p style="color:red">水果信息：{{ data.info }}</p>
                <div class="story">
                    <h5>详细介绍：</h5>
                    <p>{{ data.desc }}</p>
                </div>
            </div>
        </div>
        
        
    </script>

    <script>
        /*需求分析 
        1.页面一加载：发送ajax请求所有水果数据，显示到左侧列表
        2.点击左侧列表,右侧盒子显示对应水果详细数据
        3.默认加载第一个水果详细信息
         */

        //1.页面一加载：发送ajax请求所有水果数据，显示到左侧列表
        $.ajax({
            url:'https://autumnfish.cn/fruitApi/fruits',
            type:'get',
            dataType:'json',
            success: function(backData){
                console.log(backData);
                setTimeout(function(){
                    $('#loading').fadeOut();
                },1000);
                $('.list').html( template('fruit_list',backData));
                //列表渲染成功后，默认加载第一个水果列表信息
                $('.list li:eq(0)').click();
            }
        });

        //2.点击列表显示水果详细信息
        /* 注意点：这个列表一开始是没有得。 是后面通过ajax动态添加，所以需要注册委托事件 */
        $('body').on('click','.list li',function(){
            $.ajax({
                url:`https://autumnfish.cn/fruitApi/fruit/${$(this).attr('fruit-id')}`,
                type:'get',
                dataType:'json',
                success: function(backData){
                    console.log(backData);
                    $('.info').html( template('fruit_info',backData));
                }
            });
        });
    </script>
</body>

</html>