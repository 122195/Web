<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <script>
        /* 学习目标: XMLHttpRequest对象的两个事件 +  xhr对象的请求状态
        1. onload事件 :  服务器响应之后执行 ( 一次请求,只会执行一次 )
        2. onreadystatechange事件 : xhr请求状态变化会执行 ( 一次请求，会执行多次 )
          0: 请求未初始化  (open之前)
          1: 服务器连接已建立 (open之后)
          2: 请求已接收 ( 服务器已经收到你的请求 )
          3: 请求处理中 ( 服务器正在处理你的请求 )
          4: 请求已完成，且响应已就绪 ( 服务器完成响应, onload事件就是在这里执行 )
        */

        //(1).实例化ajax对象
        let xhr = new XMLHttpRequest()
        //请求未初始化
        console.log( xhr.readyState )//0
      
        //(2).设置请求方法和地址(请求行)
        xhr.open('post', 'http://www.liulongbin.top:3009/api/login')
        //服务器连接已建立
        console.log( xhr.readyState )//1

        //(3).设置请求头（post请求才需要设置）
        xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded')
        //(4).发送请求 ： 参数格式  'key=value' 
        xhr.send('username=admin&password=123456') 
        //(5).注册回调函数
        xhr.onreadystatechange = function () {
          console.log( xhr.readyState )//2 3 4
          
          //当readyState为4,表示响应数据了
          if( xhr.readyState == 4 ){
            console.log( xhr.response )
          }
        }


    </script>
  </body>
</html>
